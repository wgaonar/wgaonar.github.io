I"46<p>In this post, I will resume the applications of LEDs and Buttons using the methods described in the last posts. In this case, one LED will be blinking, the other flashing, another will be doing a heartbeat pattern. At the same time, two buttons will be pending for a press for the user and If it occurs, two LEDs will be turned On. All these processes will be executed for 10 seconds, which are timing within
the main routine of the program.</p>

<h2 id="circuit-and-components">Circuit and components</h2>

<p>The circuit can be seen in Figure 1. Please keep in mind that the BeagleBone works at <font color="red">3.3V</font> and not 5V like microcontrollers as Arduino. It is so important to avoid damage to the board, especially when you are working with buttons or digital inputs in general.</p>

<p>The components are:</p>
<ul>
  <li>2 Resistor of 10KΩ as a pull-down resistor</li>
  <li>5 Resistor of 1KΩ</li>
  <li>2 Push button of 12mm</li>
  <li>5 LEDs of different colors</li>
  <li>Jumpers male-male to make the connections</li>
</ul>

<figure style="text-align: center; width:70%; 
              margin-left: auto; 
              margin-right: auto;">
    <img src="../assets/images/Post20/Circuit_bb.jpg" alt="Circuit_bb.jpg" width="100%" />
  <figcaption>
    Figure 1: Circuit for doing some processes at the same time.
  </figcaption>
</figure>

<h3 id="listing_34">Listing_3.4</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;iostream&gt;
#include &lt;chrono&gt;
</span>
<span class="cp">#include "../../Sources/GPIO.h"
#include "../../Sources/BUTTON.h"
#include "../../Sources/LED.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">delayms</span><span class="p">(</span><span class="kt">int</span> <span class="n">millisecondsToSleep</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">this_thread</span><span class="o">::</span><span class="n">sleep_for</span><span class="p">(</span><span class="n">chrono</span><span class="o">::</span><span class="n">milliseconds</span><span class="p">(</span><span class="n">millisecondsToSleep</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">// Global BUTTON pins declaration</span>
<span class="n">BUTTON</span> <span class="nf">redButtonPin</span><span class="p">(</span><span class="n">P8_08</span><span class="p">);</span>
<span class="n">BUTTON</span> <span class="nf">yellowButtonPin</span><span class="p">(</span><span class="n">P8_10</span><span class="p">);</span>

<span class="c1">// GLobal LEDS pins declaration</span>
<span class="n">LED</span> <span class="nf">redLedPin</span><span class="p">(</span><span class="n">P8_12</span><span class="p">);</span>
<span class="n">LED</span> <span class="nf">yellowLedPin</span><span class="p">(</span><span class="n">P8_14</span><span class="p">);</span>
<span class="n">LED</span> <span class="nf">greenLedPin</span><span class="p">(</span><span class="n">P8_16</span><span class="p">);</span>
<span class="n">LED</span> <span class="nf">blueLedPin</span><span class="p">(</span><span class="n">P8_18</span><span class="p">);</span>
<span class="n">LED</span> <span class="nf">whiteLedPin</span><span class="p">(</span><span class="n">P8_26</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">UserCallBackFunction_RedButton</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="n">string</span> <span class="n">message</span><span class="p">;</span>
  <span class="n">message</span> <span class="o">=</span> <span class="s">"Callback function for the red button has been activated!"</span><span class="p">;</span> 
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RainbowText</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s">"Red"</span><span class="p">,</span> <span class="s">"Indigo"</span><span class="p">,</span> <span class="s">"Bold"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

  <span class="kt">int</span> <span class="n">isButtonPushed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">isButtonPushed</span> <span class="o">=</span> <span class="n">redButtonPin</span><span class="p">.</span><span class="n">WaitForButton</span><span class="p">(</span><span class="n">RISING</span><span class="p">);</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="n">isButtonPushed</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s">"The red button was pressed -&gt; turning the red Led On!!!"</span><span class="p">;</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RainbowText</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s">"Red"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">redLedPin</span><span class="p">.</span><span class="n">TurnOn</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>   
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">UserCallBackFunction_YellowButton</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">string</span> <span class="n">message</span><span class="p">;</span>
  <span class="n">message</span> <span class="o">=</span> <span class="s">"Callback function for the yellow button has been activated"</span><span class="p">;</span> 
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RainbowText</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s">"Yellow"</span><span class="p">,</span> <span class="s">"Indigo"</span><span class="p">,</span> <span class="s">"Bold"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

  <span class="kt">int</span> <span class="n">isButtonPushed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">isButtonPushed</span> <span class="o">=</span> <span class="n">yellowButtonPin</span><span class="p">.</span><span class="n">WaitForButton</span><span class="p">(</span><span class="n">FALLING</span><span class="p">);</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="n">isButtonPushed</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s">"The yellow button was pressed -&gt; turning the yellow Led On!!!"</span><span class="p">;</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RainbowText</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s">"Yellow"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">yellowLedPin</span><span class="p">.</span><span class="n">TurnOn</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>   
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"Main function starting here..."</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">RainbowText</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="s">"Blue"</span><span class="p">,</span> <span class="s">"White"</span><span class="p">,</span> <span class="s">"Bold"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

  <span class="n">message</span> <span class="o">=</span> <span class="s">"Activating blinking, flashing and heartbeat on different Leds"</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RainbowText</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s">"Orange"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

  <span class="n">greenLedPin</span><span class="p">.</span><span class="n">Blink</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
  <span class="n">blueLedPin</span><span class="p">.</span><span class="n">Flash</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span>
  <span class="n">whiteLedPin</span><span class="p">.</span><span class="n">HeartBeat</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>

  <span class="n">message</span> <span class="o">=</span> <span class="s">"The program is timing for "</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RainbowText</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s">"Indigo"</span><span class="p">);</span>
  <span class="n">message</span> <span class="o">=</span> <span class="s">"10 seconds"</span><span class="p">;</span> 
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RainbowText</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s">"Indigo"</span><span class="p">,</span> <span class="s">"Default"</span><span class="p">,</span> <span class="s">"Blink"</span><span class="p">);</span>
  <span class="n">message</span> <span class="o">=</span> <span class="s">" and is pending if a press on any button occurs"</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RainbowText</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s">"Indigo"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

  <span class="n">redButtonPin</span><span class="p">.</span><span class="n">WhenButtonWasPressed</span><span class="p">(</span><span class="o">&amp;</span><span class="n">UserCallBackFunction_RedButton</span><span class="p">);</span>
  <span class="n">yellowButtonPin</span><span class="p">.</span><span class="n">WhenButtonWasPressed</span><span class="p">(</span><span class="o">&amp;</span><span class="n">UserCallBackFunction_YellowButton</span><span class="p">);</span>
  <span class="n">delayms</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span>

  <span class="c1">// Stop the processes on the Buttons and Leds</span>
  <span class="n">redButtonPin</span><span class="p">.</span><span class="n">StopWaitForButton</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
  <span class="n">yellowButtonPin</span><span class="p">.</span><span class="n">StopWaitForButton</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
  <span class="n">greenLedPin</span><span class="p">.</span><span class="n">StopBlink</span><span class="p">();</span>
  <span class="n">blueLedPin</span><span class="p">.</span><span class="n">StopFlash</span><span class="p">();</span>
  <span class="n">whiteLedPin</span><span class="p">.</span><span class="n">StopHeartBeat</span><span class="p">();</span>

  <span class="n">message</span> <span class="o">=</span> <span class="s">"Main function ends here..."</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">RainbowText</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="s">"Blue"</span><span class="p">,</span> <span class="s">"White"</span><span class="p">,</span><span class="s">"Bold"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="execution-of-the-program">Execution of the program:</h3>
<figure style="text-align: center; width:100%; 
              margin-left: auto; 
              margin-right: auto;">
  <video width="100%" controls="" poster="../assets/images/Post20/VideoCover.png">
    <source src="../assets/images/Post20/Video.mp4" type="video/mp4" />
  </video>
  <figcaption>
    Video: Execution of the program.
  </figcaption>
</figure>

<p>Se you in the next post.</p>
:ET